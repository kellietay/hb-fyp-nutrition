{% extends 'base.html' %}
{% block content %}

<h1>Profile</h1>


<div>
    {% if 'userid' in session %}
        <h2> Welcome, {{ session['fname'] }}</h2>
        <input id="profileid" type="hidden" name="profileid" value={{ profileid }}>
        <br><br>
        {% if profiles is defined %}
        <h3>Profiles</h3>
            {% for profile in profiles %}
            <a href='/{{ session['userid'] }}/{{ profile.profile_id }}'>{{ profile.name }}'s Profile</div>
            {% endfor %}
        {% endif %}
        <a href='/profile/new-profile'> Create new profile </a>
        <br><br>
        <a href='/logout'> logout </a>
    {% else %}
        <a href='/login'> login </a>

    {% endif %}
</div>

<div>
    <form id="date-form">
        Date: <input type='date' name='date' id="inputdate">
        <input type='submit' id='submit'>
    </form>
        
</div>
<div id="profiletables">
<table>
    <tr>
        <th>Nutrient Name</th>
        <th>Reccomended Daily Value</th>
        <th>Today's Values</th>
    </tr>
    <tr>
        <td>Calories</td>
        <td>{{cal_obj.calories_modactive}}
        <td>{{total_nutrients['calories']}}</td>
    </tr>
    {%for item in nutrient_dict %}
        <tr>
            <td>{{ nutrient_dict[item] }}</td>
            <td>{{ ref_obj[item] }}</td>
            <td>{{ total_nutrients[item] }}</td>
        </tr>
    {% endfor %}
</table>

<div>
<h1>Foods eaten today</h1>
    <table>
        <tr>
            <th>Food</th>
            <th>Quantity</th>
            <th>Unit </th>
            <th>Serving Weight (g)</th>
        </tr>

    {%for item in rec_obj %}
        <tr>
            <td>{{ item.food.food_name }}</td>
            <td>{{ item.serving_qty }}</td>
            <td>{{ item.serving_unit }}</td>
            <td>{{ item.serving_weight_grams }}</td>
        </tr>
    {% endfor %}
    </table>

    <form id="add-food-records" action="/profile/{{ profileid }}/addfood">
        <input type="text" id='addfood' name='addfood'>
        <input type='submit' value="Add New Food">
    </form>
    
    <br>
    <h3> AutoComplete Test</h3>
    <form autocomplete="off" action="/action_page.php">
        <div class="autocomplete" style="width:300px;">
            <input id="myInput" type="text" name="myCountry" placeholder="Country">
        </div>
        <input type="submit">
    </form>

</div>
</div>

<script src="/static/profile.js"></script>

{% endblock %}



<!-- <script>

function replaceTables(results){
    var status = results;
    $('#profiletables').html(status);
    console.log("Finished replaceTables");
}

function updateTables(evt){
    evt.preventDefault()
    const formData = {
            inputdate: $('#inputdate').val(),
            profileid: $('#profileid').val()
        }

    $.get("/profile/retrieve", formData, replaceTables);
    console.log("ran AJAX");
}

function initReload(){
    console.log("initReload is on");
    $('#date-form').on('submit', updateTables);
}

initReload();
console.log("please run");

</script> -->